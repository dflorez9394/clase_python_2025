print("\nSISTEMA BÁSICO DE INVENTARIO Y VENTAS")
print("\t ---Administración de productos y ventas")


def registrar_nuevo_producto(productos, identificador_actual):
    print("\n--- Registro de producto ---")

    nombre_producto = input("Ingresa el nombre del producto: ")
    precio_producto = float(input("Ingresa el precio del producto: "))
    cantidad = int(input("Ingresa la cantidad de producto: "))

    estado_producto = "disponible" if cantidad > 0 else "no disponible"

    producto = {
        "identificador" : identificador_actual,
        "nombre producto" : nombre_producto,
        "precio" : precio_producto,
        "cantidad" : cantidad,
        "estado del producto": estado_producto
    }

    productos.append(producto)

    print("\tEl producto se registra correctamente")
    return identificador_actual + 1

def mostrar_producto(productos):
    if not productos:
        print("No hay productos registrados")
        return
    
    print("\n\t--- Lista de productos ----")

    for prod in productos:
        print(f"""
ID: {prod['identificador']}
Nombre producto: {prod['nombre producto']}
Precio: ${prod['precio']:.2f}
Cantidad: {prod['cantidad']}
Estado: {prod['estado del producto']}
---------------------------------""")

def buscar_producto(productos):
    busqueda_nombre = input("Buscar producto por nombre: ").lower()

    resultados = [
        p for p in productos if busqueda_nombre in p["nombre producto"].lower()
    ]

    if resultados:
        mostrar_producto(resultados)
    else:
        print("No se encontraron resultados y/o coincidencias")


def eliminar_producto(productos):
    try:
        identificador_busqueda = int(input("Ingrese identificador a eliminar: "))

        for prod in productos:
            if prod["identificador"] == identificador_busqueda:
                productos.remove(prod)
                print("Producto eliminado correctamente")
                return
        
        print("Identificador no encontrado")

    except ValueError:
        print("Ingreso no valido")

def mostrar_prod_no_disponible(productos):
    no_stock = [prod for prod in productos if prod["cantidad"] == 0]

    if no_stock:
        mostrar_producto(no_stock)
    else:
        print("Todos los productos estan disponible")

def realizar_venta(productos):
    try:
        identificador_busqueda = int(input("Ingrese el identificador del producto: "))
        cantidad_venta = int(input("Ingrese la cantidad a vender: "))

        for prod in productos:
            if prod["identificador"] == identificador_busqueda:

                if prod["estado del producto"] == "no disponible":
                    print("producto no disponible")
                    return
                
                if cantidad_venta > prod["cantidad"]:
                    print("Stock insuficiente")
                    return
                
                total = cantidad_venta * prod["precio"]
                prod["cantidad"] -= cantidad_venta

                if prod["cantidad"] == 0:
                    prod["estado del producto"] = "no disponible"

                print(f"Venta realizada. Total a pagar: {total:.2f}")
                return

        print("Producto no encontrado")

    except ValueError:
        print("Ingreso no valido")


def menu():
    productos = []
    identificador_actual = 1

    while True:
        print("***********************")
        print("Menu principal de Tienda")
        print("\t1) Registrar un nuevo producto")
        print("\t2) Mostrar todos los productos registrados")
        print("\t3) Buscar productos por nombre")
        print("\t4) Eliminar un producto")
        print("\t5) Mostrar productos sin disponibilidad")
        print("\t6) Realizar una venta")
        print("\t7) salir")
        
        opcion=int(input("Ingrese una opcion: "))
        
        if opcion == 1:
            identificador_actual = registrar_nuevo_producto(productos,identificador_actual)
        elif opcion == 2:
            mostrar_producto(productos)
        elif opcion == 3:
            buscar_producto(productos)
        elif opcion == 4:
            eliminar_producto(productos)
        elif opcion == 5:
            mostrar_prod_no_disponible(productos)
        elif opcion == 6:
            realizar_venta(productos)
        elif opcion == 7:
            print("Salir del sistema de inventario y ventas")
            break
        else:
            print("ingreso el valor incorrecto debe ingresar un numero entre 1 y 7")    
    
#El corazon de la ejecucion o centralizado de la aplicacion 
if __name__ == "__main__":
    menu()
